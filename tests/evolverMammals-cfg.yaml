#############################################################################
# This config file is a necessary input file for the cactus GPU snakemake
# pipeline. 
#
# Before using this config file, first run cactus-prepare:
# <cactus_path> cactus-prepare <input_file> --outDir <output_dir> --jobStore <tmp_dir> --gpu
#
# Then replace the values below with the same paths in the fields below
# e.g.: 
# input_file: <input_file>
# input_file: /path/to/my/input/file.txt
#
# Gregg Thomas, Spring 2022
#############################################################################

# time -p singularity exec --nv --cleanenv ../bin/cactus_v2.9.3-gpu.sif cactus-prepare evolverMammals.txt --outDir evolverMammals-out/ --outHal evolverMammals-out/evolverMammals.hal --gpu
## Note: this needs to be run in the tests/ directory so the new evolverMammals-out/evolverMammals.txt file has the correct paths.

# time -p snakemake -p -s cactus_gpu.smk --configfile tests/evolverMammals-cfg.yaml --profile profiles/slurm_profile/ --dryrun

#############################################################################

working_dir: /n/holylfs05/LABS/informatics/Users/gthomas/cactus-snakemake/tests
# Where the snakemake pipeline will be run. I usually set this one directory above my output directory, though it shouldn't matter.

#cactus_path: /n/holylfs05/LABS/informatics/Users/gthomas/cactus-snakemake/bin/cactus_v2.9.3-gpu.sif
cactus_path: download

input_file: /n/holylfs05/LABS/informatics/Users/gthomas/cactus-snakemake/tests/evolverMammals.txt
# Same as input file for cactus-prepare, though a similar file with ancestor genomes should have been created in your output directory
# when you ran cactus-prepare.

output_dir: /n/holylfs05/LABS/informatics/Users/gthomas/cactus-snakemake/tests/evolverMammals-out-gpu/
# The output directory for the snakemake pipeline. This should be the same as the outDir in cactus-prepare.
# This directory will be created if it doesn't exist.

overwrite_output_dir: True
# If the output directory already exists and you don't care if the files within it might be overwritten, set this to True.

final_hal: evolverMammals.hal
# The name you want for the final HAL file.

tmp_dir: /n/holylfs05/LABS/informatics/Users/gthomas/tmp/
# A temporary directory for snakemake and cactus to use. Should have lots of space.

use_gpu: True
# Whether or not to use the GPU version of cactus.
# If you don't have a GPU, set this to False.
# Either way, be sure to set the correct values for the partitions and GPUs below.

#############################################################################
## Below are the partitions and resources for each rule in the snakemake pipeline.
## Be sure to adjust them to meet your needs and the resources available on your cluster.
## Notably, for mask, blast, and align, if you use the GPU version of cactus, you will need to
## provide a partition with GPUs and set the gpu values to the number of GPUs you want to use.
## If you are not using the cactus GPU version, the gpu values will be ignored.

mask_partition: "gpu_test"
mask_gpu: 4
mask_cpu: 8
mask_mem: 25000
mask_time: 30

##########################

blast_partition: "gpu_test"
blast_gpu: 1
blast_cpu: 48
blast_mem: 50000
blast_time: 120

##########################

align_partition: "gpu_test"
align_gpu: 2
align_cpu: 24
align_mem: 25000 
align_time: 120

##########################

convert_partition: "shared"
convert_cpu: 8
convert_mem: 8000
convert_time: 30

##########################

copy_partition: "shared"
copy_cpu: 1
copy_mem: 8000
copy_time: 30

##########################

append_partition: "shared"
append_cpu: 8
append_mem: 8000
append_time: 30

##########################

maf_partition: "shared"
maf_cpu: 8
maf_mem: 25000
maf_time: 60

##########################